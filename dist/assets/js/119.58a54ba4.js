(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{716:function(t,s,n){"use strict";n.r(s);var e=n(8),a=Object(e.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"项目开发流程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#项目开发流程"}},[t._v("#")]),t._v(" 项目开发流程")]),t._v(" "),n("h2",{attrs:{id:"准备工作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[t._v("#")]),t._v(" 准备工作")]),t._v(" "),n("hr"),t._v(" "),n("ol",[n("li",[t._v("阿里云域名注册，ssl证书申请，ECS服务开通（具体看"),n("a",{attrs:{href:"./aliyun-server"}},[t._v("阿里云服务器相关")]),t._v("）；")]),t._v(" "),n("li",[t._v("nginx配置（具体看"),n("a",{attrs:{href:"./nginx"}},[t._v("nginx的安装与配置")]),t._v("）；")]),t._v(" "),n("li",[t._v("mysql搭建（具体看"),n("a",{attrs:{href:"./mysql"}},[t._v("msql的安装与使用")]),t._v("）")]),t._v(" "),n("li",[t._v("阿里云CentOs服务器搭建（具体看"),n("a",{attrs:{href:"./aliyun-centos"}},[t._v("阿里云centOS服务器搭建")]),t._v("）\n"),n("ul",[n("li",[t._v("node环境：nvm,node,npm,cnpm")]),t._v(" "),n("li",[t._v("nginx环境搭建，静态资源通过FileZilla上传nginx上")]),t._v(" "),n("li",[t._v("git安装")]),t._v(" "),n("li",[t._v("mysql安装")])])])]),t._v(" "),n("h2",{attrs:{id:"流程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#流程"}},[t._v("#")]),t._v(" 流程")]),t._v(" "),n("hr"),t._v(" "),n("ol",[n("li",[t._v("本地开发项目，开发完成，前端代码打包，将前端代码和后端代码"),n("code",[t._v("git push")]),t._v("到"),n("code",[t._v("github")]),t._v("仓库")]),t._v(" "),n("li",[t._v("连接服务器\n"),n("ul",[n("li",[n("code",[t._v("ping verney-zhou")]),t._v(" 连接上云服务器，"),n("code",[t._v("ssh root@verney-zhou")]),t._v("登录云服务器；")]),t._v(" "),n("li",[n("code",[t._v("nginx")]),t._v(" 启动nginx服务，"),n("code",[t._v("fileZilla")]),t._v("连接云服务器，上传静态资源文件；")]),t._v(" "),n("li",[n("code",[t._v("service mysqld start")]),t._v(" 开启mysql服务， "),n("code",[t._v("mysql -u root -p")]),t._v("登录，"),n("code",[t._v("navicat")]),t._v("连接云数据库；")])])]),t._v(" "),n("li",[t._v("发布\n"),n("ul",[n("li",[t._v("执行后端"),n("code",[t._v("shell")]),t._v("脚本，从"),n("code",[t._v("git")]),t._v("上拉取最新的代码，启动"),n("code",[t._v("node")]),t._v("服务；")]),t._v(" "),n("li",[t._v("执行前端"),n("code",[t._v("shell")]),t._v("脚本，从"),n("code",[t._v("git")]),t._v("上拉取最新的代码，打包，上传到"),n("code",[t._v("nginx")]),t._v("上；")])])]),t._v(" "),n("li",[t._v("浏览器访问")])]),t._v(" "),n("h2",{attrs:{id:"常见问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常见问题"}},[t._v("#")]),t._v(" 常见问题")]),t._v(" "),n("hr"),t._v(" "),n("ol",[n("li",[n("p",[n("strong",[t._v("前端代码为什么需要打包？")])]),t._v(" "),n("ul",[n("li",[t._v("前端浏览器只能识别js,html,css文件，需要将各种.vue，.less文件编译成浏览器能识别的文件；")]),t._v(" "),n("li",[t._v("代码中含有import，export这种模块化的es6语法，module.exports这种commonJs语法浏览器都无法识别，需要通过打包编译.")])])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("执行shell脚本时，提示：权限不够")])])])]),t._v(" "),n("blockquote",[n("p",[t._v("可参考：\n1."),n("a",{attrs:{href:"https://blog.csdn.net/idomyway/article/details/108229822",target:"_blank",rel:"noopener noreferrer"}},[t._v("Centos bash: 运行 ./xxx.sh: 权限不够"),n("OutboundLink")],1),t._v("\n2."),n("a",{attrs:{href:"https://blog.csdn.net/hsany330/article/details/49977151",target:"_blank",rel:"noopener noreferrer"}},[t._v("linux 775和777权限有什么区别"),n("OutboundLink")],1)])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@iZ2zef9ue9eyhqrvjxs3aqZ admin-book"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ./update-fe.sh")]),t._v("\n-bash: ./update-fe.sh: 权限不够\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@iZ2zef9ue9eyhqrvjxs3aqZ admin-book"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# chmod 775 ./update.sh  // chmod 775 更改用户权限")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@iZ2zef9ue9eyhqrvjxs3aqZ admin-book"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ./update.sh")]),t._v("\n")])])]),n("ol",{attrs:{start:"3"}},[n("li",[n("strong",[t._v("如何通过ip地址访问到后端api?")])])]),t._v(" "),n("blockquote",[n("p",[t._v("当静态资源已经上传到服务器上，已经可以通过ip地址"),n("code",[t._v("http://123.57.172.182/")]),t._v("访问到服务器上的资源时，这时输入："),n("code",[t._v("http://123.57.172.182:5000")]),t._v("发现无法访问后端~")])]),t._v(" "),n("ul",[n("li",[t._v("首先要在"),n("a",{attrs:{href:"https://ecs.console.aliyun.com/?spm=5176.100251.recommends.decs.62dd4f15QG9Z3L#/securityGroup/region/cn-beijing",target:"_blank",rel:"noopener noreferrer"}},[t._v("阿里云安群组规则"),n("OutboundLink")],1),t._v("中添加后端api请求的端口号：")])]),t._v(" "),n("img",{staticClass:"zoom-custom-imgs",attrs:{src:t.$withBase("/images/project/image01.png"),width:"auto"}}),t._v(" "),n("ul",[n("li",[t._v("然后在服务器上启动node服务：")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@iZ2zef9ue9eyhqrvjxs3aqZ ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd admin-book/")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@iZ2zef9ue9eyhqrvjxs3aqZ admin-book"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls")]),t._v("\nebook-admin-node  ebook-admin-vue  update-fe.sh  update.sh\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@iZ2zef9ue9eyhqrvjxs3aqZ admin-book"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ./update.sh  // 执行自动化脚本，启动node")]),t._v("\n开始更新服务端"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n正在更新代码"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n已经是最新的。\n正在重启服务"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n后台服务端启动成功"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@iZ2zef9ue9eyhqrvjxs3aqZ admin-book"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ======Http server is running on http://0.0.0.0:5000")]),t._v("\nHTTPS Server is running on: https://localhost:18082\n")])])]),n("ol",{attrs:{start:"4"}},[n("li",[n("strong",[t._v("前后端自动上线脚本")])])]),t._v(" "),n("ul",[n("li",[t._v("前端：update-fe.sh")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"start updating frontend..."')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /root/admin-book\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# git clone git@github.com:verneyZhou/ebook-admin-vue.git // 第一次执行时打开")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ebook-admin-vue\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"updating source..."')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" pull\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"frontend building"')]),t._v("\ncnpm i\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"frontend publish"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" -rf ~/nginx/upload/admin-fe  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除原nginx上的文件")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mv")]),t._v(" dist ~/nginx/upload/admin-fe "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 将最新打包后的文件dist移动到~/nginx/upload/admin-fe")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"finish updating frontend..."')]),t._v("\n")])])]),n("ul",[n("li",[t._v("后端：update.sh")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"开始更新服务端..."')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" /root/admin-book\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# git clone git@github.com:verneyZhou/ebook-admin-node.git // 第一次执行时打开")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" ebook-admin-node\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"正在更新代码..."')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" pull\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"正在重启服务..."')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("kill")]),t._v(" -9 "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" -ef"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("node")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" app.js"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("awk")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{print $2}'")]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关闭所有node服务")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  ps -ef|grep node 查看所有开启的node服务")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  grep app.js  过滤只包含 app.js 的指令")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  awk '{print $2}'  $fileName :   一行一行的读取指定的文件， 以空格作为分隔符，打印第二个字段")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  kill -9  强制关闭进程")]),t._v("\ncnpm i\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("node")]),t._v(" app.js "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("     "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 加上&可以让node在后台也能运行")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"后台服务端启动成功!"')]),t._v("\n")])])]),n("p",[n("a",{attrs:{href:"https://blog.csdn.net/guo_guo_cai/article/details/78499477",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考"),n("OutboundLink")],1)]),t._v(" "),n("ol",{attrs:{start:"5"}},[n("li",[n("p",[n("strong",[t._v("http、https端口号")])]),t._v(" "),n("ul",[n("li",[t._v("一个端口号对应一个服务；")]),t._v(" "),n("li",[t._v("nginx上放的是静态资源，node上放的是后端代码；访问静态资源需输入nginx配置的端口号，访问后端api需输入node配置的端口号；")]),t._v(" "),n("li",[t._v("nginx配置\n"),n("ul",[n("li",[t._v("http服务的默认端口号是80,即浏览器输入：http://localhost:80 访问的就是http://localhost；nginx.conf配置中默认配置的端口号是8080；")]),t._v(" "),n("li",[t._v("https的默认端口号是443，即浏览器输入：https://localhost:443 访问的就是https://localhost；一般https的配置在upload.conf中添加；")])])]),t._v(" "),n("li",[t._v("后端node配置\n"),n("ul",[n("li",[t._v("http服务监听的是5000端口，浏览器输入http://localhost:5000/book/list 访问的是后端 /book/list 接口；")]),t._v(" "),n("li",[t._v("https服务监听的是18082端口，浏览器输入：https://localhost:18082/book/list 访问后端/book/list接口；")])])]),t._v(" "),n("li",[t._v("mysql的默认数据库端口是3306；")]),t._v(" "),n("li",[t._v("3389 端口是电脑远程控制的端口")])])]),t._v(" "),n("li",[n("p",[n("code",[t._v("Invalid Host header")])])])]),t._v(" "),n("blockquote",[n("p",[t._v("本地启动项目，用"),n("code",[t._v("switchHost")]),t._v("将"),n("code",[t._v("localhost")]),t._v("代理到线上域名"),n("code",[t._v("www.verneyzhou-code.cn")]),t._v("，项目跑起来后，浏览器输入该域名报："),n("code",[t._v("Invalid Host header")])])]),t._v(" "),n("p",[t._v("因为新版的webpack-dev-server出于安全考虑，默认检查hostname，如果hostname不是配置内的就不能访问。可通过vue.config.js中配置解决：")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[t._v("module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("devServer")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("disableHostCheck")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("ol",{attrs:{start:"7"}},[n("li",[t._v("ECS服务器的nginx.conf上配置了https，并添加了证书，但浏览器输入"),n("code",[t._v("https://www.verneyzhou-code.cn")]),t._v("没有反应")])]),t._v(" "),n("blockquote",[n("p",[t._v("检查下ECS控制台的"),n("a",{attrs:{href:"https://ecs.console.aliyun.com/?spm=5176.12818093.recommend.decs.75e316d0JIQoQA#/securityGroup/region/cn-beijing",target:"_blank",rel:"noopener noreferrer"}},[t._v("安全组规则"),n("OutboundLink")],1),t._v("是否已已添加了"),n("code",[t._v("443")]),t._v("端口：\nECS控制台 》 网络与安全 》 安全组 》 手动添加")])]),t._v(" "),n("img",{staticClass:"zoom-custom-imgs",attrs:{src:t.$withBase("/images/project/flow001.jpeg"),width:"auto"}}),t._v(" "),n("p",[t._v("添加之后，重启服务器的nginx，再次输入链接应该就可以了~")]),t._v(" "),n("ol",{attrs:{start:"8"}},[n("li",[t._v("执行 "),n("code",[t._v("ssh root@123.57.172.182")]),t._v(" 时报错："),n("code",[t._v("kex_exchange_identification: read: Connection reset by peer")])])]),t._v(" "),n("blockquote",[n("p",[t._v("在 "),n("a",{attrs:{href:"https://www.ip138.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("ip138"),n("OutboundLink")],1),t._v("中查询自己本机外网ip地址，然后在"),n("a",{attrs:{href:"https://ecs.console.aliyun.com/securityGroupDetail/region/cn-beijing/groupId/sg-2ze0p2g1civnu847xgde/detail/intranetIngress",target:"_blank",rel:"noopener noreferrer"}},[t._v("阿里云服务器安全规则"),n("OutboundLink")],1),t._v(" "),n("code",[t._v("22/22")]),t._v(" 端口中添加即可~")])]),t._v(" "),n("blockquote",[n("p",[t._v("也有可能是公司网络的限制，因为遇到过在公司登录时会报错，在家里就可以的情况~")])]),t._v(" "),n("ol",{attrs:{start:"9"}},[n("li",[t._v("用FileZilla连接远程ip站点时报错：")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("狀態:\t正在解析 verney-zhou 的 IP 位址\n狀態:\t正在連線到 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("123.57")]),t._v(".172.182:21"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n錯誤:\t"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" 秒後無動作, 連線逾時\n錯誤:\t無法連線到伺服器 \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或者")]),t._v("\n狀態:\t以 "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ECONNREFUSED - 連線被伺服器拒絕"')]),t._v(" 嘗試連線失敗.\n")])])]),n("blockquote",[n("p",[t._v("左上角【文件】 》 站点 》 设置 》协议：选择"),n("code",[t._v("SFTP协议")]),t._v("即可，即选择ssh传输~")])]),t._v(" "),n("fix-link",{attrs:{label:"Back",href:"/project/vue-node-admin/"}})],1)}),[],!1,null,null,null);s.default=a.exports}}]);