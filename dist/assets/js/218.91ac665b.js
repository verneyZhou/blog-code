(window.webpackJsonp=window.webpackJsonp||[]).push([[218],{811:function(t,s,a){"use strict";a.r(s);var n=a(8),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"uniapp与微前端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#uniapp与微前端"}},[t._v("#")]),t._v(" uniapp与微前端")]),t._v(" "),a("h2",{attrs:{id:"uniapp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#uniapp"}},[t._v("#")]),t._v(" uniapp")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://uniapp.dcloud.net.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("uniapp官方文档"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"微前端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#微前端"}},[t._v("#")]),t._v(" 微前端")]),t._v(" "),a("blockquote",[a("p",[t._v("微前端是一种多个团队通过独立发布功能的方式来共同构建现代化 web 应用的技术手段及方法策略。其实，简单点来说就是：微前端是一种前端架构设计模式，其思想是"),a("strong",[t._v("将一个大型的前端应用拆分成多个独立的小型子应用，每个子应用都可以独立开发、构建、测试和部署，并且可以被组合成一个完整的前端应用")]),t._v("。")])]),t._v(" "),a("p",[a("strong",[t._v("微前端是一种设计架构，并不是技术")]),t._v("。是借鉴于微服务思想的设计架构，是一种为了解决庞大且难以维护的项目的方案。")]),t._v(" "),a("ul",[a("li",[t._v("微前端解决了什么问题")])]),t._v(" "),a("ol",[a("li",[t._v("大型应用程序的维护困难")]),t._v(" "),a("li",[t._v("大型应用程序的可扩展性问题")]),t._v(" "),a("li",[t._v("多团队协同开发问题")])]),t._v(" "),a("ul",[a("li",[t._v("微前端具备的核心价值")])]),t._v(" "),a("ol",[a("li",[t._v("技术栈无关")]),t._v(" "),a("li",[t._v("独立开发、独立部署")]),t._v(" "),a("li",[t._v("增量升级")]),t._v(" "),a("li",[t._v("独立运行时")])]),t._v(" "),a("ul",[a("li",[t._v("微前端的优点")])]),t._v(" "),a("ol",[a("li",[t._v("更好的代码可维护性")]),t._v(" "),a("li",[t._v("降低了开发的成本以及复杂性")]),t._v(" "),a("li",[t._v("更好的可重用性和可扩展性")]),t._v(" "),a("li",[t._v("更高的可靠性和安全性")])]),t._v(" "),a("p",[t._v("微前端的缺点: 技术复杂度更高, 存在技术风险, 项目总体运行效率可能会变慢")]),t._v(" "),a("h3",{attrs:{id:"微前端解决跨域的方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#微前端解决跨域的方案"}},[t._v("#")]),t._v(" 微前端解决跨域的方案")]),t._v(" "),a("ul",[a("li",[t._v("Proxy")])]),t._v(" "),a("blockquote",[a("p",[t._v("通过配置Web服务器反向代理，将多个前端应用程序转发到同一个主机的端口上。需要Nginx、Apache等服务器和一个负载均衡模块，允许所有的请求通过同一个域名和端口号对外访问。")])]),t._v(" "),a("ul",[a("li",[t._v("iframe")])]),t._v(" "),a("blockquote",[a("p",[t._v("我们可以通过"),a("code",[t._v("iframe")]),t._v("标签来解决主应用与子应用的跨域问题，主应用程序通过iframe标签嵌入子应用，并且使用postMessage来允许不同iframe元素之间进行通信。")])]),t._v(" "),a("ul",[a("li",[t._v("CORS： "),a("code",[t._v('"Access-Control-Allow-Origin": "*"')])])]),t._v(" "),a("h3",{attrs:{id:"微前端架构方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#微前端架构方案"}},[t._v("#")]),t._v(" 微前端架构方案")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("自由组织模式")])]),t._v(" "),a("li",[a("p",[t._v("基座模式")])])]),t._v(" "),a("blockquote",[a("p",[t._v("将多个子应用程序作为模块加载到一个主应用程序中。这些模块是独立的小型应用程序。每个子应用程序都可以独立开发、测试、部署，而主应用程序主要就是将子应用进行集成和协调，子应用程序发生变化，主应用程序也会自动的完成更新。")])]),t._v(" "),a("p",[t._v("基座模式需要使用一些基础设施来支持子应用程序加载、路由和通信")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://zh-hans.single-spa.js.org/docs/getting-started-overview",target:"_blank",rel:"noopener noreferrer"}},[t._v("Single-SPA"),a("OutboundLink")],1),t._v("：一个支持多框架、多技术栈的JavaScript微前端框架，用于构建大型单页应用程序。")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://qiankun.umijs.org/zh/guide",target:"_blank",rel:"noopener noreferrer"}},[t._v("qiankun"),a("OutboundLink")],1),t._v("：一个基于Single-SPA封装的微前端框架，支持React、Vue、Angular等技术栈。")]),t._v(" "),a("ul",[a("li",[t._v("去中心化模式")])]),t._v(" "),a("p",[t._v("是在多个子应用程序之间创建对等的关系，每个应用程序对应整个应用程序系统来说都是平等的。")]),t._v(" "),a("h3",{attrs:{id:"single-spa实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#single-spa实践"}},[t._v("#")]),t._v(" Single-SPA实践")]),t._v(" "),a("h4",{attrs:{id:"创建主应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建主应用"}},[t._v("#")]),t._v(" 创建主应用")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("npx create-single-spa\n\n? Directory "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" new project wei-fe-spa "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 项目名称")]),t._v("\n? Select "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" to generate single-spa root config "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建微前端容器应用，根应用就是主应用，负责加载其他子应用，并作为单页应用（SPA）的容器。")]),t._v("\n? Which package manager "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" you want to use? "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pnpm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# pnpm")]),t._v("\n? Will this project use Typescript? Yes "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ts")]),t._v("\n? Would you like to use single-spa Layout Engine No "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# no")]),t._v("\n? Organization name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("can use letters, numbers, dash or underscore"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" zhou "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 组织名称")]),t._v("\n")])])]),a("h4",{attrs:{id:"创建react子应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建react子应用"}},[t._v("#")]),t._v(" 创建react子应用")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" wei-fe-spa\n\n➜  wei-fe-spa git:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("master"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ✗ npx create-single-spa\n? Directory "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" new project react-project "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 子项目名称")]),t._v("\n? Select "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" to generate single-spa application / parcel "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 微前端架构中的子应用程序，可以使用Vue、React、Angular框架，可以利用根应用提供的共享工具和服务进行通信。")]),t._v("\n? Which framework "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" you want to use? react "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 选择框架")]),t._v("\n? Which package manager "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" you want to use? "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pnpm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# pnpm")]),t._v("\n? Will this project use Typescript? Yes "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ts")]),t._v("\n? Organization name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("can use letters, numbers, dash or underscore"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" zhou "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 组织名称")]),t._v("\n? Project name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("can use letters, numbers, dash or underscore"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" react-project "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 项目名称")]),t._v("\n")])])]),a("ul",[a("li",[t._v("注册子应用")])]),t._v(" "),a("div",{staticClass:"language-ts extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// wei-fe-spa/src/zhou-root-config.ts")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注册子应用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerApplication")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@zhou/react-project"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("app")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("import")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@zhou/react-project"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  activeWhen"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/react-project"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("ul",[a("li",[t._v("声明导入配置:")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// wei-fe-spa/src/index.ejs")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"systemjs-importmap"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"imports"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"single-spa"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://cdn.jsdelivr.net/npm/single-spa@5.9.0/lib/system/single-spa.min.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 以cdn的形式导入react */")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"react"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://unpkg.com/react@17/umd/react.production.min.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"react-dom"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("isLocal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"systemjs-importmap"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"imports"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"@zhou/root-config"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"//localhost:9000/zhou-root-config.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 声明导入路径 */")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"@zhou/react-project"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"//localhost:9010/zhou-react-project.js"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这个路径可以进入到子应用，直接 npm run start 启动子应用，在页面上即可看到~")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n")])])]),a("ul",[a("li",[a("p",[a("code",[t._v("npm run start")]),t._v(", 先启动子应用，再启动主应用")])]),t._v(" "),a("li",[a("p",[t._v("访问主应用服务："),a("code",[t._v("http://localhost:9000")]),t._v("，访问子应用服务："),a("code",[t._v("http://localhost:9000/react-project")])])])]),t._v(" "),a("h4",{attrs:{id:"创建vue子应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建vue子应用"}},[t._v("#")]),t._v(" 创建vue子应用")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("➜  wei-fe-spa git:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("master"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ✗ npx create-single-spa\n? Directory "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" new project vue-demo\n? Select "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" to generate single-spa application / parcel\n? Which framework "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" you want to use? vue\n? Organization name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("can use letters, numbers, dash or underscore"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" zhou\n")])])]),a("p",[t._v("注册，配置跟上面的react一样~")]),t._v(" "),a("h4",{attrs:{id:"创建公共模块子应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建公共模块子应用"}},[t._v("#")]),t._v(" 创建公共模块子应用")]),t._v(" "),a("blockquote",[a("p",[t._v("跨应用通信")])]),t._v(" "),a("ul",[a("li",[t._v("创建：")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("➜  wei-fe-spa git:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("master"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ✗ npx create-single-spa\n? Directory "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" new project utils\n? Select "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" to generate in-browser utility module "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("styleguide, api cache, \netc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 公共模块应用，非渲染组件，可以在不同应用之间共享JavaScript模块和组件。")]),t._v("\n? Which framework "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" you want to use? none\n? Which package manager "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" you want to use? "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pnpm")]),t._v("\n? Will this project use Typescript? Yes\n? Organization name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("can use letters, numbers, dash or underscore"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" zhou\n? Project name "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("can use letters, numbers, dash or underscore"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" utils\n")])])]),a("ul",[a("li",[t._v("导出函数：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// wei-fe-spa/utils/src/zhou-utils.ts")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 导出一个函数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addFn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("a")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("b")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" b\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("ul",[a("li",[t._v("主应用中导入，跟上面的react一样，然后"),a("code",[t._v("npm run start")]),t._v("启动项目")])]),t._v(" "),a("blockquote",[a("p",[t._v("这只是一个工具库，无需注册路由~")])]),t._v(" "),a("ul",[a("li",[t._v("vue子应用中使用：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// wei-fe-spa/vue-demo/src/App.vue")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mounted")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    System"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("import")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@zhou/utils'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'res.addFn(1, 2)'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addFn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"qiankun"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#qiankun"}},[t._v("#")]),t._v(" qiankun")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://qiankun.umijs.org/zh",target:"_blank",rel:"noopener noreferrer"}},[t._v("qiankun官网"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("qiankun是一个基于Single-SPA的微前端解决方案，它可以帮我们将多个独立的前端应用整合到一个整体，并实现这些应用的共享和协同。")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("特性")]),t._v(" "),a("ol",[a("li",[t._v("基于single-spa封装，提供了更加开箱即用的API。")]),t._v(" "),a("li",[t._v("与技术栈无关，任意技术栈的应用均可使用/接入，不论是react、vue、angular还是其他框架。")]),t._v(" "),a("li",[t._v("html entry接入方式，让你接入微应用像使用iframe一样简单。")]),t._v(" "),a("li",[t._v("样式隔离，确保微应用之间样式互相不干扰。")]),t._v(" "),a("li",[t._v("js沙箱，确保微应用之间全局变量/事件不冲突。")]),t._v(" "),a("li",[t._v("资源预加载，在浏览器空闲时间预加载未打开的微应用资源，加快微应用打开速度。")])])]),t._v(" "),a("p",[a("strong",[t._v("Q：why not iframe?")])]),t._v(" "),a("blockquote",[a("p",[t._v("如果不考虑体验问题，iframe 几乎是最完美的微前端解决方案了。")])]),t._v(" "),a("p",[t._v("iframe 最大的特性就是提供了浏览器原生的硬隔离方案，不论是样式隔离、js 隔离这类问题统统都能被完美解决。但他的最大问题也在于他的隔离性无法被突破，导致应用间上下文无法被共享，随之带来的开发体验、产品体验的问题：")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("url 不同步")]),t._v("。浏览器刷新 iframe url 状态丢失、后退前进按钮无法使用。")]),t._v(" "),a("li",[a("strong",[t._v("UI 不同步，DOM 结构不共享")]),t._v("。想象一下屏幕右下角 1/4 的 iframe 里来一个带遮罩层的弹框，同时我们要求这个弹框要浏览器居中显示，还要浏览器 resize 时自动居中..")]),t._v(" "),a("li",[a("strong",[t._v("全局上下文完全隔离，内存变量不共享")]),t._v("。iframe 内外系统的通信、数据同步等需求，主应用的 cookie 要透传到根域名都不同的子应用中实现免登效果。")]),t._v(" "),a("li",[a("strong",[t._v("慢")]),t._v("。每次子应用进入都是一次浏览器上下文重建、资源重新加载的过程。")])]),t._v(" "),a("blockquote",[a("p",[t._v("其中有的问题比较好解决(问题1)，有的问题我们可以睁一只眼闭一只眼(问题4)，但有的问题我们则很难解决(问题3)甚至无法解决(问题2)，而这些无法解决的问题恰恰又会给产品带来非常严重的体验问题， 最终导致我们舍弃了 iframe 方案。")])]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.yuque.com/kuitos/gky7yw/gesexv",target:"_blank",rel:"noopener noreferrer"}},[t._v("Why Not Iframe"),a("OutboundLink")],1)]),t._v(" "),a("h4",{attrs:{id:"通信"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通信"}},[t._v("#")]),t._v(" 通信")]),t._v(" "),a("ul",[a("li",[t._v("在主应用中进行注册的时候可以传递props参数；在子应用index.js文件中的mount生命周期中获取props参数")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在主应用中进行注册的时候可以传递props参数:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerMicroApps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"reactApp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("entry")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"//localhost:3011"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("container")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#micro-app1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("activeRule")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/micro-app1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("props")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"青峰1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vueApp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("entry")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"//localhost:3012"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("container")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#micro-app2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("activeRule")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/micro-app2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("props")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"青峰2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 子应用入口文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("props")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[react16] props from main framework"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 监听主应用传递的数据")]),t._v("\n  props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onGlobalStateChange")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prev")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// state: 变更后的状态; prev 变更前的状态")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prev"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 向主应用传递数据")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// props.setGlobalState(state);")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"更改react配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更改react配置"}},[t._v("#")]),t._v(" 更改react配置")]),t._v(" "),a("p",[t._v("方案1：暴露webapck配置信息：react-scripts eject")]),t._v(" "),a("blockquote",[a("p",[t._v("会暴露所有配置信息")])]),t._v(" "),a("p",[t._v("方案2："),a("a",{attrs:{href:"https://www.npmjs.com/package/react-app-rewired",target:"_blank",rel:"noopener noreferrer"}},[t._v("react-app-rewired"),a("OutboundLink")],1)]),t._v(" "),a("blockquote",[a("p",[t._v("此工具可以在不 'eject' 也不创建额外 react-scripts 的情况下修改 create-react-app 内置的 webpack 配置，然后你将拥有 create-react-app 的一切特性，且可以根据你的需要去配置 webpack 的 plugins, loaders 等。")])]),t._v(" "),a("h4",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),a("p",[t._v("微前端是指将前端应用程序拆分成更小的独立部分，然后将其组合成一个整体应用程序。这种架构方式可以使不同团队独立开发、部署和维护各自的功能模块，从而提高应用程序的可维护性、灵活性和可扩展性。")]),t._v(" "),a("blockquote",[a("p",[t._v("微前端未来的发展趋势将会是更加成熟化和标准化。目前还有一些痛点，例如多语言支持、子应用间通信、路由同步等问题需要解决。因此，微前端框架和相关工具的发展将会更加完善，提供更好的解决方案来解决这些问题。同时，由于微前端的高度灵活性，未来很有可能出现类似于微服务的组织模式，即更多的团队会提供独立的子应用来实现一些业务需求。")])]),t._v(" "),a("h3",{attrs:{id:"备注"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#备注"}},[t._v("#")]),t._v(" 备注")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("微前端解决的是隔离和通信，monorepo解决的是组件共享")])])]),t._v(" "),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),a("ul",[a("li",[a("p",[a("a",{attrs:{href:"https://vzx6t9oio6.feishu.cn/docx/Ct0MdxEkHop3G0xVH33cV4sGnmd",target:"_blank",rel:"noopener noreferrer"}},[t._v("Uniapp基础入门"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://vzx6t9oio6.feishu.cn/docx/KhdKdpfROozOEIxbn51c1S8Bnwf",target:"_blank",rel:"noopener noreferrer"}},[t._v("微前端快速入门"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://www.ruanyifeng.com/blog/2017/05/server-sent_events.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Server-Sent Events 教程"),a("OutboundLink")],1)])])]),t._v(" "),a("blockquote",[a("p",[t._v("服务端发送的不是一次性的数据包，而是一个数据流，会连续不断地发送过来。这时，客户端不会关闭连接，会一直等着服务器发过来的新的数据流，视频播放、chatgpt聊天消息发送就是这样的")])])])}),[],!1,null,null,null);s.default=e.exports}}]);