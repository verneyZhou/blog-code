(window.webpackJsonp=window.webpackJsonp||[]).push([[97],{691:function(t,e,s){"use strict";s.r(e);var a=s(8),r=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"微信h5项目开发流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#微信h5项目开发流程"}},[t._v("#")]),t._v(" 微信H5项目开发流程")]),t._v(" "),s("h2",{attrs:{id:"项目搭建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#项目搭建"}},[t._v("#")]),t._v(" 项目搭建")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("vue+webpack")]),t._v("搭建项目\n"),s("ul",[s("li",[t._v("适配：amfe-flexible + postcss-px2rem-exclude")]),t._v(" "),s("li",[t._v("ui库：vant")])])])]),t._v(" "),s("blockquote",[s("p",[t._v("具体搭建流程见另一篇博客："),s("RouterLink",{attrs:{to:"/skills/webpack/vue-use.html"}},[t._v("vue+webpack搭建项目流程梳理")]),t._v(";")],1)]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[s("code",[t._v("jenkins")]),t._v("配置")])]),t._v(" "),s("blockquote",[s("p",[t._v("新建的项目需要配置它的测试环境和线上环境，这里我是用jenkins进行配置；配置成功后可以在不同环境通过域名访问~")])]),t._v(" "),s("blockquote",[s("p",[t._v("接下来就可以开始开发项目了~")])]),t._v(" "),s("h2",{attrs:{id:"开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开发"}},[t._v("#")]),t._v(" 开发")]),t._v(" "),s("p",[t._v("这部分就是日常"),s("code",[t._v("src")]),t._v("里面的内容，不再赘述~")]),t._v(" "),s("p",[t._v("等到项目开发完毕，就可以进入测试了~")]),t._v(" "),s("h2",{attrs:{id:"测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[t._v("#")]),t._v(" 测试")]),t._v(" "),s("blockquote",[s("p",[t._v("开发微信h5页面最主要两点是："),s("strong",[t._v("微信授权、jssdk的初始化及使用")]),t._v("；关于微信授权流程和jssdk的流程这里不详述了，具体可看另一篇博文："),s("a",{attrs:{href:"./auth"}},[t._v("微信授权及jssdk初始化")]),t._v("~")])]),t._v(" "),s("ol",[s("li",[s("a",{attrs:{href:"https://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&t=sandbox/index",target:"_blank",rel:"noopener noreferrer"}},[t._v("申请测试公众号"),s("OutboundLink")],1)])]),t._v(" "),s("blockquote",[s("p",[t._v("在这个页面添加js安全域名：qa测试环境域名，不用带https://；扫描二维码添加测试号开发者，不添加的话jssdk初始化会报错，不能使用wx的分享、上传图片等api~")])]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("添加授权回调域名：体验接口权限表/网页服务/网页账号/网页授权获取用户基本信息，输入域名，和上面的测试域名一样")])]),t._v(" "),s("blockquote",[s("p",[t._v("添加授权回调域名，不用添加https://，之后在项目中授权回调的路径需在此域名下~")])]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("之后便可以在项目里面进行auth授权，jssdk的初始化；测试时，将代码部署到测试环境，可直接在微信里访问链接进行测试~")])]),t._v(" "),s("blockquote",[s("p",[t._v("测试时，微信得先关注测试公众号成为开发者才能访问正常授权，线上公众号不需要~")])]),t._v(" "),s("h2",{attrs:{id:"部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署"}},[t._v("#")]),t._v(" 部署")]),t._v(" "),s("p",[t._v("jenkins上新建一个项目，用于部署dev和qa环境，并添加shell脚本；同时再新建一个项目，用于部署上线，同样添加shell脚本~")]),t._v(" "),s("p",[t._v("之后就可以通过jenkins进行部署了~")]),t._v(" "),s("h2",{attrs:{id:"上线"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#上线"}},[t._v("#")]),t._v(" 上线")]),t._v(" "),s("ol",[s("li",[t._v("gitlub新建一个项目，提工单，申请一个新域名")])]),t._v(" "),s("blockquote",[s("p",[t._v("申请域名步骤应该只有leader才有权限~")])]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("正式公众号配置js安全域名，回调域名，ip白名单，业务域名...（一般前端申请域名后，由后端配置这些..）")]),t._v(" "),s("li",[t._v("部署\n"),s("ul",[s("li",[t._v("jenkins部署")]),t._v(" "),s("li",[t._v("在jenkins没有配置打包命令之前，可通过手动打包上线~")])])])]),t._v(" "),s("blockquote",[s("p",[t._v("打包之后会生成dist文件夹，然后将该文件夹里的内容拷贝到线上项目；一般拷贝之后，push到gitlab上就已经上线了，可通过线上链接进行访问")])]),t._v(" "),s("h2",{attrs:{id:"其他"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[t._v("#")]),t._v(" 其他")]),t._v(" "),s("h3",{attrs:{id:"功能点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#功能点"}},[t._v("#")]),t._v(" 功能点")]),t._v(" "),s("ul",[s("li",[t._v("提示框方式")]),t._v(" "),s("li",[t._v("上传接口？chooseImage上传图片怎么传字段？")]),t._v(" "),s("li",[t._v("搜索弹出键盘？")]),t._v(" "),s("li",[t._v("路由？vue-router-sync?")]),t._v(" "),s("li",[t._v("滚动分页？")]),t._v(" "),s("li",[t._v("vuex 固化")]),t._v(" "),s("li",[t._v("下拉刷新")]),t._v(" "),s("li",[t._v("骨架屏")]),t._v(" "),s("li",[t._v("懒加载")]),t._v(" "),s("li",[t._v("公众测试号配置的url地址？端口号80?")]),t._v(" "),s("li",[t._v("分享api更改？")]),t._v(" "),s("li",[t._v("touchmove事件 节流")]),t._v(" "),s("li",[t._v("eslint格式， 保存自动fix")]),t._v(" "),s("li",[t._v("身份判断 底部菜单显隐")])]),t._v(" "),s("h3",{attrs:{id:"流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#流程"}},[t._v("#")]),t._v(" 流程")]),t._v(" "),s("ol",[s("li",[t._v("首次进入页面，判断url后面是否带有weixin_token参数，有则将这个参数保存，并添加到接口的请求头里~")]),t._v(" "),s("li",[t._v("如果接口返回root:{code:302,redirectUrl: '......'}，则需要重新授权，手动跳转返回的rediectUrl~")]),t._v(" "),s("li",[t._v("后端完成授权，会重定向到带有weixin_token参数的url，前端重复步骤1操作~")])]),t._v(" "),s("blockquote",[s("p",[t._v("这个url是前端授权时当前页面的url~")])]),t._v(" "),s("ol",{attrs:{start:"4"}},[s("li",[t._v("完成授权之后，取到weixin_token参数，调获取用户信息接口，判断是否是员工~调职位列表接口~")])]),t._v(" "),s("h2",{attrs:{id:"bug记录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bug记录"}},[t._v("#")]),t._v(" bug记录")]),t._v(" "),s("ol",[s("li",[t._v('Vue中img图像src变成"[object Module]"无法正确加载的问题')])]),t._v(" "),s("blockquote",[s("p",[s("a",{attrs:{href:"https://www.jianshu.com/p/0877ce441561",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考"),s("OutboundLink")],1)])]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("警告："),s("code",[t._v("Second Autoprefixer control comment was ignored. Autoprefixer applies control comment to whole block, not to next rules.")])])]),t._v(" "),s("img",{staticClass:"zoom-custom-imgs",attrs:{src:t.$withBase("/images/mobile/mobile003.png"),width:"auto"}}),t._v(" "),s("div",{staticClass:"language-css extra-class"},[s("pre",{pre:!0,attrs:{class:"language-css"}},[s("code",[s("span",{pre:!0,attrs:{class:"token selector"}},[t._v(".ellipse-3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("display")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" -webkit-box"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 单独写-webkit-box-orient这个属性wepack打包会被过滤掉 */")]),t._v("\n    // "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*! autoprefixer: off */")]),t._v("\n    // 注释掉，改用下面的写法\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*! autoprefixer: ignore next */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("-webkit-box-orient")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" vertical"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* autoprefixer: on */")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("-webkit-line-clamp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("overflow")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hidden"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("word-wrap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" break-word"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[t._v("微信jssdk初始化的时候，报：63002；")])]),t._v(" "),s("img",{staticClass:"zoom-custom-imgs",attrs:{src:t.$withBase("/images/mobile/mobile004.png"),width:"auto"}}),t._v(" "),s("p",[t._v("jssdk初始化的时候传参url为当前页面url，因为获取签名的url必须与当前页面的url一致（也有可能是后端对url的某些特殊字符进行加密处理后导致url前后不一致，导致签名失效）~")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://developers.weixin.qq.com/community/develop/doc/0000e2f5d0cdc02c0a391aedd58c00?jumpto=comment&commentid=000e44fc9c43680c0b3924ae15b0",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考"),s("OutboundLink")],1)]),t._v(" "),s("fix-link",{attrs:{label:"Back",href:"/project/mobile-h5/"}})],1)}),[],!1,null,null,null);e.default=r.exports}}]);